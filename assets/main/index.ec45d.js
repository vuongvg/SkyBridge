window.__require=function t(e,o,n){function i(c,l){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var a="function"==typeof __require&&__require;if(!l&&a)return a(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var p=o[c]={exports:{}};e[c][0].call(p.exports,function(t){return i(e[c][1][t]||t)},p,p.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({BridgeController:[function(t,e,o){"use strict";cc._RF.push(e,"7f151LSnAdPb7dd9AUStQpN","BridgeController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),l=t("../Global"),s=t("./Bridge"),a=cc._decorator,p=a.ccclass,u=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bridgePrefab=null,e._lengthBridge=0,e._isPress=!1,e._currentBridge=null,e._currentBridgeScript=null,e._graPhics=null,e._offset=Math.sqrt(3)/2,e.GROW=5,e}return i(e,t),e.prototype.onLoad=function(){c.eventTarget.on(c.RESET_GAME,this.resetBridge,this),c.eventTarget.on(c.TOUCH_START,this.createBridge,this),c.eventTarget.on(c.TOUCH_END,this.onBridge,this),c.eventTarget.on(c.DROP_BRIDGE,this.dropBridge,this),this._graPhics=this.node.getComponent(cc.Graphics),this._graPhics.lineWidth=5,this._graPhics.strokeColor=cc.Color.WHITE,this.initPool()},e.prototype.initPool=function(){for(var t=0;t<4;t++){var e=cc.instantiate(this.bridgePrefab);e.position=cc.v3(0,-1e3),e.parent=this.node,e.setContentSize(e.getContentSize().width,0)}},e.prototype.resetBridge=function(){this._isPress=!1,this._currentBridge=null,this.node.children.forEach(function(t){t.height=0,t.position=cc.v3(0,-1e3)})},e.prototype.createBridge=function(){this._isPress=!0,this._lengthBridge=0;var t=this.node.children;this._currentBridge=t[t.length-1],this._currentBridgeScript=this._currentBridge.getComponent(s.default),this._currentBridgeScript.init(),c.eventTarget.emit(c.BRIDGE_SOUND)},e.prototype.update=function(){this._isPress&&this._currentBridge&&(1.9*(l.Global.nextBuilding.node.position.y-l.Global.currentBuilding.node.position.y)<this._lengthBridge||(this._lengthBridge+=this.GROW,this._currentBridgeScript.growBridge(this._lengthBridge)))},e.prototype.drawCircle=function(t,e){this._graPhics.clear(),this._graPhics.circle(t.x,t.y,e),this._graPhics.stroke()},e.prototype.onBridge=function(){if(this._isPress=!1,this._lengthBridge<40)return l.Global.isGamePlaying=!0,void(this._currentBridge.position=cc.v3(0,-1e3));this._currentBridgeScript.onBridge(this._lengthBridge)},e.prototype.dropBridge=function(){this._isPress=!1,this._currentBridgeScript.dropBridge(this._lengthBridge)},r([u(cc.Prefab)],e.prototype,"bridgePrefab",void 0),r([p],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../Events":"Events","../Global":"Global","./Bridge":"Bridge"}],Bridge:[function(t,e,o){"use strict";cc._RF.push(e,"97a1bpKiGlLKZ0RKtVF9nE/","Bridge");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),l=t("../Global"),s=cc._decorator,a=s.ccclass,p=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.START_ANGLE=-30,e.START_SKEW=-30,e.END_SKEW=30,e.DROP_SKEW=80,e._collider=null,e._allNameColliders=["OkColliderDown","GoodColliderDown","PrefectCollider","GoodColliderUp","OkColliderUp","OutSide"],e._bonusArr=[1,1,1,-1,-1,-2],e._allColliders=[],e._bonus=0,e._offset=Math.sqrt(3)/2,e}return i(e,t),e.prototype.onLoad=function(){this._collider=this.getComponent(cc.BoxCollider)},e.prototype.init=function(){this._collider.enabled=!0,this._allColliders=[],this._bonus=0,this.node.setSiblingIndex(0);var t=l.Global.dirX,e=l.Global.currentBuilding,o=l.Global.bridgePoints,n=e.buildingType;this.node.height=0,this.node.angle=t*this.START_ANGLE,this.node.skewX=t*this.START_SKEW,this.node.opacity=255;var i=e.node.position,r=o[n].clone().multiply(cc.v3(t,1)),c=i.clone().add(r);this.node.position=c,cc.Tween.stopAll()},e.prototype.growBridge=function(t){this.node.height=t,this._collider.size.height=t,this._collider.offset.y=t/2},e.prototype.onBridge=function(t){var e=this,o=l.Global.dirX;cc.tween(this.node).to(.15,{height:1.2*t,skewX:o*this.START_SKEW*.5}).to(.1,{height:1.1*t,skewX:o*this.END_SKEW*.5}).to(.05,{height:t,skewX:o*this.END_SKEW}).call(function(){0==e._bonus&&(e.node.height-=3),e._bonus<0&&(e.node.height+=10),e._bonus>0&&(e._collider.enabled=!1),c.eventTarget.emit(c.CHECK_GAME_OVER,e._bonus,e),c.eventTarget.emit(c.BRIDGE_HIT_SOUND)}).start()},e.prototype.dropBridge=function(t){var e=this;cc.tween(this.node).delay(.5).to(.3,{height:.15*t,skewX:l.Global.dirX*this.DROP_SKEW}).call(function(){e.node.opacity=0}).start()},e.prototype.onShake=function(){cc.tween(this.node).by(.1,{angle:-1}).by(.1,{angle:1}).call(function(){return c.eventTarget.emit(c.NEXT_LEVEL)}).start()},e.prototype.onCollisionEnter=function(t){var e=this;this._allNameColliders.find(function(o,n){t.node.name.includes(o)&&!e._allColliders.includes(o)&&(e._allColliders.push(o),e._bonus+=e._bonusArr[n])})},r([a],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],Brother:[function(t,e,o){"use strict";cc._RF.push(e,"4c5bc5FVuhBwLyFOGIvxvMg","Brother");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),l=t("../Global"),s=cc._decorator,a=s.ccclass,p=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.movePos=[],e}return i(e,t),e.prototype.init=function(t,e){var o=this;this.node.parent=t,this.node.position=e,this.node.scaleX=.6*l.Global.dirX,this.node.opacity=0,this.scheduleOnce(function(){o.node.opacity=255},.2),c.eventTarget.on(c.BROTHER_START_TWEEN,this.startTween,this)},e.prototype.startTween=function(t){var e=this,o=cc.tween(this.node);this.movePos.forEach(function(n){o=o.sequence(cc.tween().call(function(){e.node.scaleX=e.node.position.x>n.x?-.6:.6}),cc.tween().to(t,{position:n},{easing:"linear"}))}),o.start()},r([a],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],Building:[function(t,e,o){"use strict";cc._RF.push(e,"95c18R1NvxLoZYdINvNUFnk","Building");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Enums"),l=t("../Global"),s=cc._decorator,a=s.ccclass,p=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.points=[],e.buildingType=c.BuildingType.medium,e._collider=[],e._dirs=[cc.v3(1,1),cc.v3(-1,1),cc.v3(1,-1),cc.v3(-1,-1)],e}return i(e,t),e.prototype.init=function(t,e,o,n,i,r){var s=this;void 0===r&&(r=c.BuildingType.medium),this.node.parent=t,this.node.position=e,this.node.scale=o,this.buildingType=r;var a=l.Global.bridgePoints[r],p=this.node.getComponentsInChildren(cc.Sprite),u=p[0],h=p.slice(1),d=h.slice(4,6)[0],_=l.Global.dirX>0,f=d.node.angle,g=d.node.skewX;d.node.active=Boolean(i),d.node.angle=_?-Math.abs(f):Math.abs(f),d.node.skewX=_?Math.abs(g):-Math.abs(g),d.node.position=cc.v3(),d.spriteFrame=i,u.node.setAnchorPoint(l.Global.anchors[r]),u.spriteFrame=n,h.slice(0,4).forEach(function(t,e){t.node.position=a.clone().multiply(s._dirs[e]),s.points.push(t.node)});var v=(cc.Vec3.distance(h[0].node.position,h[3].node.position)-65)/2;this._collider=d.getComponentsInChildren(cc.BoxCollider);var y=this._collider,S=y[0],O=y[1],E=(y[2],y[3],y[4],y[5]);O.offset.y=32.5+v/2,E.offset.y=-32.5-v/2,S.offset.y=32.5+2*v,O.size.height=v,E.size.height=v,S.size.height=2*v,cc.tween(this.node).to(.4,{scale:1.2*o}).to(.1,{scale:.9*o}).to(.1,{scale:o}).start()},e.prototype.onShake=function(){var t=this.node.position.clone(),e=cc.v3(t.x,t.y-20);cc.tween(this.node).to(.1,{position:e}).to(.1,{position:t}).start()},r([a],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../Enums":"Enums","../Global":"Global"}],Enums:[function(t,e,o){"use strict";cc._RF.push(e,"c50b9zv7O9JoKK52uY5dJ9p","Enums"),Object.defineProperty(o,"__esModule",{value:!0}),o.BuildingType=void 0,function(t){t[t.medium=0]="medium",t[t.small=1]="small",t[t.large=2]="large"}(o.BuildingType||(o.BuildingType={})),cc._RF.pop()},{}],Events:[function(t,e,o){"use strict";cc._RF.push(e,"6cdd6WUrBtHbafbvNBsiIqp","Events"),Object.defineProperty(o,"__esModule",{value:!0}),o.BRIDGE_HIT_SOUND=o.PERFECT_SOUND=o.OK_SOUND=o.GOOD_SOUND=o.MOVE_SOUND=o.FAIL_SOUND=o.HIT_COIN_SOUND=o.BRIDGE_SOUND=o.BUILDING_SOUND=o.BG_SOUND=o.SHOW_BONUS=o.SHOW_MULTIPLY_SCORE=o.SHOW_GAME_OVER=o.SHOW_HOME=o.BROTHER_START_TWEEN=o.BROTHER_MOVE=o.DROP_PLAYER_OUT_SIDE=o.DROP_PLAYER=o.DROP_BRIDGE=o.MOVE_TO_TARGET=o.INIT_PLAYER=o.SET_HIGH_SCORE=o.SET_LEVEL=o.SET_SCORE=o.NEXT_LEVEL=o.TOUCH_END=o.TOUCH_START=o.CHECK_GAME_OVER=o.GAME_OVER=o.RESET_GAME=o.START_GAME=o.eventTarget=void 0,o.eventTarget=new cc.EventTarget,o.START_GAME="START_GAME",o.RESET_GAME="RESET_GAME",o.GAME_OVER="GAME_OVER",o.CHECK_GAME_OVER="CHECK_GAME_OVER",o.TOUCH_START="TOUCH_START",o.TOUCH_END="TOUCH_END",o.NEXT_LEVEL="NEXT_LEVEL",o.SET_SCORE="SET_SCORE",o.SET_LEVEL="SET_LEVEL",o.SET_HIGH_SCORE="SET_HIGH_SCORE",o.INIT_PLAYER="INIT_PLAYER",o.MOVE_TO_TARGET="MOVE_TO_TARGET",o.DROP_BRIDGE="DROP_BRIDGE",o.DROP_PLAYER="DROP_PLAYER",o.DROP_PLAYER_OUT_SIDE="DROP_PLAYER_OUT_SIDE",o.BROTHER_MOVE="BROTHER_MOVE",o.BROTHER_START_TWEEN="BROTHER_START_TWEEN",o.SHOW_HOME="SHOW_HOME",o.SHOW_GAME_OVER="SHOW_GAME_OVER",o.SHOW_MULTIPLY_SCORE="SHOW_MULTIPLY_SCORE",o.SHOW_BONUS="SHOW_BONUS",o.BG_SOUND="BG_SOUND",o.BUILDING_SOUND="BUILDING_SOUND",o.BRIDGE_SOUND="BRIDGE_SOUND",o.HIT_COIN_SOUND="HIT_COIN_SOUND",o.FAIL_SOUND="FAIL_SOUND",o.MOVE_SOUND="MOVE_SOUND",o.GOOD_SOUND="GOOD_SOUND",o.OK_SOUND="OK_SOUND",o.PERFECT_SOUND="PERFECT_SOUND",o.BRIDGE_HIT_SOUND="BRIDGE_HIT_SOUND",cc._RF.pop()},{}],GameController:[function(t,e,o){"use strict";cc._RF.push(e,"058a6TnBFVILpDMjdfEruXh","GameController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Enums"),l=t("../Events"),s=t("../Global"),a=t("../LocalStorage"),p=t("./Building"),u=t("./PlayerController"),h=cc._decorator,d=h.ccclass,_=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buildingBlock=null,e.buildingPrefab=null,e.spriteFramesUpFace=[],e.spriteFramesBuilding=[],e._stepY=0,e._stepX=0,e._posY=-200,e._posX=300,e._perfectCount=0,e._playerNode=null,e._buildingCount=1,e}return i(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,l.eventTarget.on(l.NEXT_LEVEL,this.startLevel,this),l.eventTarget.on(l.RESET_GAME,this.resetGame,this),l.eventTarget.on(l.CHECK_GAME_OVER,this.checkGameOver,this),this.initPool(),this._playerNode=this.getComponentInChildren(u.default).node},e.prototype.start=function(){this.getDataFromLocalStorage()},e.prototype.getDataFromLocalStorage=function(){var t=a.LocalStogate.getLevel(),e=a.LocalStogate.getHighScore();t&&(s.Global.level=t,l.eventTarget.emit(l.SET_LEVEL)),e&&(s.Global.highScore=e,l.eventTarget.emit(l.SET_HIGH_SCORE))},e.prototype.checkGameOver=function(t,e){var o=s.Global.nextBuilding.node.position,n=s.Global.currentBuilding.node.position;if(0==(t=this.getRandomInt(1,4))){var i=o.clone().add(n).multiplyScalar(.5);return l.eventTarget.emit(l.DROP_PLAYER,i),void l.eventTarget.emit(l.DROP_BRIDGE)}if(t<0)l.eventTarget.emit(l.DROP_PLAYER_OUT_SIDE,o);else{var r=s.Global.level*Math.pow(2,t-1);3==t?(this._perfectCount++,r*=this._perfectCount):this._perfectCount=0;var c=s.Global.score+r,p=s.Global.getFibonacci(s.Global.level+1);s.Global.score>=p&&(s.Global.level++,a.LocalStogate.setLevel(s.Global.level)),c>=s.Global.highScore&&(s.Global.highScore=c,l.eventTarget.emit(l.SET_HIGH_SCORE),a.LocalStogate.setHighScore(s.Global.highScore)),e.onShake(),s.Global.nextBuilding.onShake(),l.eventTarget.emit(l.SET_SCORE,s.Global.score,r),l.eventTarget.emit(l.MOVE_TO_TARGET,o),l.eventTarget.emit(l.SHOW_MULTIPLY_SCORE,s.Global.level),l.eventTarget.emit(l.SHOW_BONUS,t,this._perfectCount);var u=[l.OK_SOUND,l.GOOD_SOUND,l.PERFECT_SOUND];l.eventTarget.emit(u[t-1]),s.Global.score=c}},e.prototype.initPool=function(){for(var t=0;t<6;t++){var e=cc.instantiate(this.buildingPrefab);e.parent=this.buildingBlock,e.getComponentInChildren(cc.Sprite).spriteFrame=null}},e.prototype.resetGame=function(){this._stepY=0,this._stepX=0,this._posY=-200,this._posX=300,this._buildingCount=1,this.buildingBlock.children.forEach(function(t){t.position=cc.v3(0,-1e3)}),this.node.position=cc.v3(),this.node.scale=1,s.Global.score=0,this.initBuildingStart()},e.prototype.initBuildingStart=function(){var t=this,e=this.buildingBlock.children[0],o=this.spriteFramesBuilding[0],n=e.getComponent(p.default);s.Global.currentBuilding=n,n.init(this.buildingBlock,cc.v3(0,200),.5,o,null,c.BuildingType.medium);var i=cc.v3(this._posX*s.Global.dirX/2,this._posY);s.Global.posStart=i,l.eventTarget.emit(l.INIT_PLAYER),cc.tween(e).to(1,{position:i,scale:1}).call(function(){return t.startLevel()}).delay(1).call(function(){return s.Global.isGamePlaying=!0}).start()},e.prototype.startLevel=function(){this.createNextBuilding()},e.prototype.createNextBuilding=function(){this._buildingCount++,s.Global.dirX*=-1,this._posY+=this._stepY;var t=this.getRandomInt(0,this.spriteFramesBuilding.length);s.Global.nextBuilding&&(s.Global.currentBuilding=s.Global.nextBuilding);var e=this.buildingBlock.children[this.buildingBlock.children.length-1],o=e.getComponent(p.default);s.Global.nextBuilding=o;var n=this.spriteFramesBuilding[t],i=s.Global.currentBuilding.node.position,r=(180+s.Global.angle*s.Global.dirX)%180,c=this._buildingCount<3,a=c?this.getRandomInt(.7*this._posX,.9*this._posX):this.getRandomInt(this._posX*Math.min(1+.005*this._buildingCount,1.3),this._posX*Math.min(1.4+.01*this._buildingCount,2.6)),u=this.findNextPoint(i,a,r);this._stepX=this.node.position.x+(u.x+i.x)/2;var h=540/(1.4*cc.Vec3.distance(cc.v3(u.x),cc.v3(i.x)));c?(this._stepX=0,this._stepY=0):(this._stepY=u.y-i.y,cc.tween(this.node).to(1,{scale:h}).start());var d=c?-200:-400,_=cc.v3(this.node.position.x-this._stepX,-this._playerNode.position.y+d).multiplyScalar(h);cc.tween(this.node).to(1,{position:_}).start();var f=this.spriteFramesUpFace[t%5],g=Math.floor(t/5);o.init(this.buildingBlock,u,1,n,f,g),e.setSiblingIndex(0),l.eventTarget.emit(l.BUILDING_SOUND)},e.prototype.findNextPoint=function(t,e,o){var n=o*(Math.PI/180),i=t.x+e*Math.cos(n),r=t.y+e*Math.sin(n);return new cc.Vec3(i,r)},e.prototype.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},r([_(cc.Node)],e.prototype,"buildingBlock",void 0),r([_(cc.Prefab)],e.prototype,"buildingPrefab",void 0),r([_([cc.SpriteFrame])],e.prototype,"spriteFramesUpFace",void 0),r([_([cc.SpriteFrame])],e.prototype,"spriteFramesBuilding",void 0),r([d],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Enums":"Enums","../Events":"Events","../Global":"Global","../LocalStorage":"LocalStorage","./Building":"Building","./PlayerController":"PlayerController"}],GameOverScreen:[function(t,e,o){"use strict";cc._RF.push(e,"460beyEjLlL743RVCrN5b8q","GameOverScreen");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),l=t("../Global"),s=cc._decorator,a=s.ccclass,p=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scoreText=null,e._highScoreText=null,e._popup=null,e}return i(e,t),e.prototype.onLoad=function(){var t,e=this;t=this.node.getComponentsInChildren(cc.Label),this._highScoreText=t[0],this._scoreText=t[1];var o=this.node.getComponentsInChildren(cc.Button),n=o[0],i=o[1];this._popup=this.node.children[1],c.eventTarget.on(c.GAME_OVER,this.onShowGameOver,this),n.node.on("click",function(){c.eventTarget.emit(c.SHOW_HOME),e.node.active=!1}),i.node.on("click",function(){c.eventTarget.emit(c.RESET_GAME),e.node.active=!1}),this.node.active=!1,this.node.position=cc.v3()},e.prototype.onShowGameOver=function(){c.eventTarget.emit(c.FAIL_SOUND),this.node.active=!0,this._scoreText.string="SCORE: "+l.Global.score,this._highScoreText.string="BEST: "+l.Global.highScore,this._popup.scale=0,cc.tween(this._popup).to(.5,{scale:1}).start()},r([a],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],GamePlayScreen:[function(t,e,o){"use strict";cc._RF.push(e,"98c8cqOvoxMC6A3XVy0wIrA","GamePlayScreen");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),l=t("../Global"),s=cc._decorator,a=s.ccclass,p=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bonusContentNode=null,e.bonusNode=null,e.scoreNode=null,e.scoreBlock=null,e.levelBlock=null,e._titleText=null,e._bonusText=null,e._bonusTexts=["OK","GOOD","PERFECT"],e._scoreText=null,e._highScoreText=null,e._currentLevelText=null,e._nextLevelText=null,e._levelProgress=null,e._bg=null,e.colors=[new cc.Color(90,122,224),new cc.Color(90,122,224),new cc.Color(214,65,89)],e}return i(e,t),e.prototype.onLoad=function(){var t,e,o;t=this.bonusNode.getComponentsInChildren(cc.Label),this._titleText=t[0],this._bonusText=t[1],e=this.scoreNode.getComponentsInChildren(cc.Label),this._highScoreText=e[0],this._scoreText=e[1],o=this.levelBlock.getComponentsInChildren(cc.Label),this._currentLevelText=o[0],this._nextLevelText=o[1],this._levelProgress=this.levelBlock.getComponentInChildren(cc.ProgressBar),this._bg=this.bonusNode.getComponentInChildren(cc.Sprite).node,this.bonusNode.active=!1,c.eventTarget.on(c.SET_SCORE,this.setScore,this),c.eventTarget.on(c.SET_LEVEL,this.setLevel,this),c.eventTarget.on(c.SET_HIGH_SCORE,this.setHighScore,this),c.eventTarget.on(c.GAME_OVER,this.onGameOver,this),c.eventTarget.on(c.RESET_GAME,this.showTopBar,this),c.eventTarget.on(c.SHOW_BONUS,this.showBonus,this),this.scoreBlock.opacity=0,this.scoreBlock.scale=0,this.node.position=cc.v3(),this._levelProgress.progress=0},e.prototype.showBonus=function(t,e){this.bonusNode.active=!0,this.bonusNode.opacity=255,this.bonusNode.scale=0,this.bonusContentNode.scale=0,this._bg.color=this.colors[t-1],this._titleText.string=e<2?this._bonusTexts[t-1]:"PERFECT x"+e;var o=l.Global.level*Math.pow(2,t-1);e>0&&(o*=e),this._bonusText.string="+"+o,cc.tween(this.bonusNode).to(.3,{scale:1}).delay(.5).to(.5,{opacity:0}).start(),cc.tween(this.bonusContentNode).to(.2,{scale:2}).to(.1,{scale:1}).start()},e.prototype.onGameOver=function(){cc.tween(this.scoreBlock).to(.5,{opacity:0,scale:0}).start()},e.prototype.showTopBar=function(){this._scoreText.string="0",this._highScoreText.string="BEST: "+l.Global.highScore,cc.tween(this.scoreBlock).to(.5,{opacity:255,scale:1}).start()},e.prototype.setScore=function(t,e){var o=this,n=0;this.schedule(function(){n++,o._scoreText.string=""+(t+Math.floor(e*n/30)),n>25&&(o._scoreText.string=""+(t+e))},0,30,0);var i=l.Global.level;this._currentLevelText.string=""+i,this._nextLevelText.string=""+(i+1);var r=l.Global.getFibonacci(l.Global.level+1),c=l.Global.getFibonacci(l.Global.level);10==c&&(c=0),this._levelProgress.progress=(l.Global.highScore-c)/(r-c)},e.prototype.setHighScore=function(){this._highScoreText.string="BEST: "+l.Global.highScore},e.prototype.setLevel=function(){var t=l.Global.level;this._currentLevelText.string=""+t,this._nextLevelText.string=""+(t+1)},r([p(cc.Node)],e.prototype,"bonusContentNode",void 0),r([p(cc.Node)],e.prototype,"bonusNode",void 0),r([p(cc.Node)],e.prototype,"scoreNode",void 0),r([p(cc.Node)],e.prototype,"scoreBlock",void 0),r([p(cc.Node)],e.prototype,"levelBlock",void 0),r([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],Global:[function(t,e,o){"use strict";cc._RF.push(e,"99f76r4q9VI75VyO3dmcZf9","Global"),Object.defineProperty(o,"__esModule",{value:!0}),o.Global=void 0;var n=function(){function t(){}return t.getFibonacci=function(t){t+=1;for(var e=[0,1],o=2;o<t;o++)e[o]=e[o-1]+e[o-2];return 10*(e=e.slice(t-2,t)).reduce(function(t,e){return t+e},0)},t.angle=30,t.dirX=1,t.currentBuilding=null,t.nextBuilding=null,t.posStart=null,t.bridgePoints=[cc.v3(37,23),cc.v3(34,17),cc.v3(48,28)],t.anchors=[cc.v2(.505,.89),cc.v2(.54,.88),cc.v2(.483,.878)],t.upFacePos=[{v:cc.v3(1.1,1.5),h:cc.v3(.5,1.8)},{v:cc.v3(-1.6,-.2),h:cc.v3(-.3,-.3)},{v:cc.v3(-.3,1.1),h:cc.v3(1.6,1)}],t.score=0,t.highScore=0,t.level=1,t.isGamePlaying=!1,t.isGameOver=!1,t}();o.Global=n,cc._RF.pop()},{}],HomeScreen:[function(t,e,o){"use strict";cc._RF.push(e,"58c00wFfC1BH5luYCapQ5mh","HomeScreen");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),l=cc._decorator,s=l.ccclass,a=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){this.getComponentInChildren(cc.Button).node.on("click",this.onButtonPlayClick,this),c.eventTarget.on(c.SHOW_HOME,this.showHomeScreen,this),this.node.position=cc.v3()},e.prototype.onButtonPlayClick=function(){this.node.active=!1,c.eventTarget.emit(c.RESET_GAME)},e.prototype.showHomeScreen=function(){this.node.active=!0},r([s],e)}(cc.Component));o.default=a,cc._RF.pop()},{"../Events":"Events"}],LocalStorage:[function(t,e,o){"use strict";cc._RF.push(e,"9c520AjziNCuLU+TvD+mp7i","LocalStorage"),Object.defineProperty(o,"__esModule",{value:!0}),o.LocalStogate=void 0;var n=function(){function t(){}return t.setLevel=function(t){localStorage.setItem(this.LEVEL,t.toString())},t.getLevel=function(){return Number(localStorage.getItem(this.LEVEL))},t.getHighScore=function(){return Number(localStorage.getItem(this.HIGH_SCORE))},t.setHighScore=function(t){localStorage.setItem(this.HIGH_SCORE,t.toString())},t.clear=function(){localStorage.clear()},t.LEVEL="SKY_BRIDGE_LEVEL",t.HIGH_SCORE="SKY_BRIDGE_HIGH_SCORE",t}();o.LocalStogate=n,cc._RF.pop()},{}],PlayerController:[function(t,e,o){"use strict";cc._RF.push(e,"95c05RfkR9J5qdnu+qB4p63","PlayerController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],c=0,l=r.length;c<l;c++,i++)n[i]=r[c];return n};Object.defineProperty(o,"__esModule",{value:!0});var l=t("../Events"),s=t("../Global"),a=t("./Brother"),p=cc._decorator,u=p.ccclass,h=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.brotherPrefab=null,e.parentBrother=null,e.parentPlayerDrop=null,e.multiplyScore=null,e._brothers=[],e._targetOutside=null,e._isMoveToEndBridge=!1,e._multiplyScoreText=null,e._parentPlayerMove=null,e._posMove=[],e.BRIDGE="Bridge",e}return i(e,t),e.prototype.onLoad=function(){l.eventTarget.on(l.INIT_PLAYER,this.reset,this),l.eventTarget.on(l.RESET_GAME,this.reset,this),l.eventTarget.on(l.MOVE_TO_TARGET,this.moveToTarget,this),l.eventTarget.on(l.DROP_PLAYER,this.dropPlayer,this),l.eventTarget.on(l.DROP_PLAYER_OUT_SIDE,this.dropPlayerOutside,this),this._parentPlayerMove=this.node.parent,this._multiplyScoreText=this.multiplyScore.getComponentInChildren(cc.Label),this.multiplyScore.active=!1,l.eventTarget.on(l.SHOW_MULTIPLY_SCORE,this.showMultiplyScore,this)},e.prototype.update=function(t){this._isMoveToEndBridge&&(this.node.position=this.node.position.add(this._targetOutside.mul(500*t)))},e.prototype.showMultiplyScore=function(t){this.multiplyScore.active=!0,this._multiplyScoreText.string="x"+t,this.multiplyScore.position=cc.v3(0,100),this.multiplyScore.opacity=255,this.multiplyScore.scaleX=s.Global.dirX,cc.tween(this.multiplyScore).to(.5,{position:cc.v3(0,200)}).to(.5,{opacity:0,position:cc.v3(0,300)}).start()},e.prototype.dropPlayer=function(t,e){var o=this;void 0===e&&(e=.5),cc.tween(this.node).to(e,{position:t}).delay(.4).call(function(){o.node.parent=o.parentPlayerDrop,o.node.setSiblingIndex(Math.round(e))}).by(.5,{position:cc.v3(0,-500,0),opacity:-255}).call(function(){l.eventTarget.emit(l.GAME_OVER),o.node.parent=o._parentPlayerMove}).start()},e.prototype.dropPlayerOutside=function(t){this._targetOutside=t.clone().sub(this.node.position).normalize(),this._isMoveToEndBridge=!0},e.prototype.reset=function(){var t=this;this._isMoveToEndBridge=!1,this._targetOutside=null,this.node.position=s.Global.posStart,this._brothers.forEach(function(e){e.opacity=0,e.position=t.node.position}),this.node.setSiblingIndex(this.node.parent.children.length-1),this.node.opacity=0,cc.tween(this.node).delay(1).to(.2,{opacity:255}).call(function(){t.node.scaleX=s.Global.dirX,t._brothers.forEach(function(t){t.opacity=255})}).start()},e.prototype.moveToTarget=function(t){var e=this;this._posMove=[],s.Global.level>this.parentBrother.children.length+1&&this.parentBrother.children.length<40&&this.initBrother(),this.node.setSiblingIndex(this.node.parent.children.length-2);for(var o=t.clone().sub(this.node.position),n=o.mag(),i=40/n,r=o.normalize().mul(n*i),p=0;p<Math.round(1/i)+1;p++)this._posMove.push(this.node.position.clone().add(r.mul(p)));var u=c(this._posMove);for(p=0;p<this._brothers.length;p++){var h=this._brothers[p],d=h.getComponent(a.default);u.pop(),d.movePos=c(u),u.unshift(h.position)}l.eventTarget.emit(l.BROTHER_START_TWEEN,i),cc.tween(this.node).to(1,{position:t}).call(function(){e.node.scaleX=s.Global.dirX,s.Global.isGamePlaying=!0}).start(),l.eventTarget.emit(l.MOVE_SOUND)},e.prototype.initBrother=function(){var t=cc.instantiate(this.brotherPrefab);t.getComponent(a.default).init(this.parentBrother,this.node.position),this._brothers.push(t)},e.prototype.onCollisionExit=function(t){t.node.name==this.BRIDGE&&this._isMoveToEndBridge&&(this.dropPlayer(this.node.position,0),this._isMoveToEndBridge=!1)},r([h(cc.Prefab)],e.prototype,"brotherPrefab",void 0),r([h(cc.Node)],e.prototype,"parentBrother",void 0),r([h(cc.Node)],e.prototype,"parentPlayerDrop",void 0),r([h(cc.Node)],e.prototype,"multiplyScore",void 0),r([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Events":"Events","../Global":"Global","./Brother":"Brother"}],SoundManager:[function(t,e,o){"use strict";cc._RF.push(e,"b1018ueVdlLLYwNLM/Sns3I","SoundManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Events"),l=cc._decorator,s=l.ccclass,a=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgSound=null,e.buildingSound=null,e.bridgeSound=null,e.hitCoinSound=null,e.failSound=null,e.moveSound=null,e.goodSound=null,e.okSound=null,e.perfectSound=null,e.bridgeHitSound=null,e}return i(e,t),e.prototype.onLoad=function(){c.eventTarget.on("BG_SOUND",this.playBgSound,this),c.eventTarget.on("BUILDING_SOUND",this.playBuildingSound,this),c.eventTarget.on("BRIDGE_SOUND",this.playBridgeSound,this),c.eventTarget.on("HIT_COIN_SOUND",this.playHitCoinSound,this),c.eventTarget.on("FAIL_SOUND",this.playFailSound,this),c.eventTarget.on("MOVE_SOUND",this.playMoveSound,this),c.eventTarget.on("GOOD_SOUND",this.playGoodSound,this),c.eventTarget.on("OK_SOUND",this.playOkSound,this),c.eventTarget.on("PERFECT_SOUND",this.playPerfectSound,this),c.eventTarget.on("BRIDGE_HIT_SOUND",this.playBridgeHitSound,this)},e.prototype.playBgSound=function(){this.bgSound.play()},e.prototype.playBuildingSound=function(){this.buildingSound.play()},e.prototype.playBridgeSound=function(){this.bridgeSound.play()},e.prototype.playHitCoinSound=function(){this.hitCoinSound.play()},e.prototype.playFailSound=function(){this.failSound.play()},e.prototype.playMoveSound=function(){this.moveSound.play()},e.prototype.playGoodSound=function(){this.goodSound.play()},e.prototype.playOkSound=function(){this.okSound.play()},e.prototype.playPerfectSound=function(){this.perfectSound.play()},e.prototype.playBridgeHitSound=function(){this.bridgeHitSound.play()},r([a(cc.AudioSource)],e.prototype,"bgSound",void 0),r([a(cc.AudioSource)],e.prototype,"buildingSound",void 0),r([a(cc.AudioSource)],e.prototype,"bridgeSound",void 0),r([a(cc.AudioSource)],e.prototype,"hitCoinSound",void 0),r([a(cc.AudioSource)],e.prototype,"failSound",void 0),r([a(cc.AudioSource)],e.prototype,"moveSound",void 0),r([a(cc.AudioSource)],e.prototype,"goodSound",void 0),r([a(cc.AudioSource)],e.prototype,"okSound",void 0),r([a(cc.AudioSource)],e.prototype,"perfectSound",void 0),r([a(cc.AudioSource)],e.prototype,"bridgeHitSound",void 0),r([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Events":"Events"}],TouchController:[function(t,e,o){"use strict";cc._RF.push(e,"1de58hbbttC8odbVf3C4vRq","TouchController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),l=t("../Global"),s=cc._decorator,a=s.ccclass,p=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isTouchStart=!1,e}return i(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},e.prototype.onTouchStart=function(){l.Global.isGamePlaying&&!this._isTouchStart&&(this._isTouchStart=!0,c.eventTarget.emit(c.TOUCH_START))},e.prototype.onTouchEnd=function(){l.Global.isGamePlaying&&this._isTouchStart&&(l.Global.isGamePlaying=!1,this._isTouchStart=!1,c.eventTarget.emit(c.TOUCH_END))},r([a],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}]},{},["Enums","Events","Bridge","BridgeController","Brother","Building","GameController","PlayerController","TouchController","Global","LocalStorage","SoundManager","GameOverScreen","GamePlayScreen","HomeScreen"]);